(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{0:function(e,t,n){n("NyhP"),e.exports=n("ftlp")},"002B":function(e,t,n){},"8SHQ":function(e,t,n){e.exports=n("kygt")},ftlp:function(e,t,n){"use strict";n.r(t);var r=n("q1tI"),o=n.n(r),a=(n("55Ip"),n("Ty5D"),n("i8i4")),i=(n("dE+T"),n("YJVH"),n("bHtr"),n("0l/t"),n("dRSK"),n("INYr"),n("6VaU"),n("8+KV"),n("HEwt"),n("Z2Ku"),n("V+eJ"),n("LK8F"),n("yt8O"),n("mGWK"),n("bWfx"),n("6AQ9"),n("DNiP"),n("SPin"),n("dZ+Y"),n("Vd3H"),n("0E+W"),n("eM6i"),n("jqX0"),n("AphP"),n("yM4b"),n("h7Nl"),n("2Spj"),n("IXt9"),n("f3/d"),n("9AAn"),n("fyVe"),n("U2t9"),n("2atp"),n("+auO"),n("MtdB"),n("Jcmo"),n("nzyx"),n("BC7C"),n("x8ZO"),n("9P93"),n("BJ/l"),n("eHKK"),n("pp/T"),n("CyHz"),n("bBoP"),n("x8Yj"),n("hLT2"),n("xfY5"),n("Ljet"),n("/KAi"),n("fN96"),n("7h0T"),n("sbF8"),n("h/M4"),n("knhD"),n("XfKG"),n("BP8U"),n("91GP"),n("hHhE"),n("RQRG"),n("/uf1"),n("HAE/"),n("WLL4"),n("/8Fb"),n("DW2E"),n("mYba"),n("jm62"),n("JduL"),n("5Pf0"),n("uaHG"),n("ZNX/"),n("mura"),n("Btvt"),n("25dN"),n("Zshi"),n("V/DX"),n("FlsD"),n("RW0V"),n("z2o2"),n("/SS/"),n("hhXQ"),n("VRzm"),n("CX2u"),n("3xty"),n("I5cv"),n("iMoV"),n("uhZd"),n("0YWM"),n("694e"),n("LTTk"),n("9rMk"),n("IlFx"),n("xpiv"),n("oZ/O"),n("klPD"),n("knU9"),n("Oyvg"),n("OEbY"),n("SRfc"),n("pIFo"),n("KKXr"),n("OG14"),n("a1Th"),n("T39b"),n("ioFf"),n("rE2o"),n("hEkN"),n("nIY7"),n("+oPb"),n("SMB2"),n("oDIu"),n("rvZc"),n("0mN4"),n("bDcW"),n("nsiH"),n("VpUO"),n("L9s1"),n("0LDn"),n("XfO3"),n("tUrg"),n("9XZr"),n("7VC1"),n("eI33"),n("FLlr"),n("84bF"),n("9VmF"),n("FEjr"),n("Zz4T"),n("JCqj"),n("Tze0"),n("I74W"),n("fA63"),n("xm80"),n("Ji/l"),n("sFw1"),n("NO8f"),n("aqI/"),n("Faw5"),n("r1bV"),n("tuSo"),n("nCnK"),n("Y9lz"),n("Tdpu"),n("EK0E"),n("wCsR"),n("R5XZ"),n("Ew+T"),n("rGqo"),n("ls82"),n("qKs0"),n("VXxg"),n("DpIS"),n("bZMm"),n("cr+I")),c=n("1OyB"),u=n("vuIU"),s=n("md7G"),l=n("foSv"),d=n("Ji7U"),f=n("17x9"),p=n.n(f),h=n("i7EJ"),m=n("K4CH"),v=n.n(m),b=n("8SHQ"),E="https://lens.".concat(n.n(b).a.host),y=function(e){return fetch("".concat(E,"/").concat(e),{headers:{"X-Referer":document.referrer,"Content-Type":"application/json","X-App-Za.OS":"webplayer"},credentials:"include"})},g=n("vN+2"),w=n.n(g),O={PLAY_FAILED:"playfailed",PLAY_COUNT:"playcount",PLAY_BUFFERING:"playbuffering",BUFFERING_TIME:"bufferingtime",FIRST_FRAME_TIME:"firstframetime"},S=v()(navigator.userAgent);function P(e){var t=e.msg,n=e.id,r=e.time,o=void 0===r?0:r,a=e.quality,c=e.detail,u=void 0===c?"":c,s=e.f,l=e.bu,d=e.v,f=e.platform;if(n){var p=Object(i.stringify)({type:"msg",msg:t,time:o,videoid:n,playtype:"inline",quality:a,platform:f,version:"1.0.0",f:s,bu:l,v:d,timestamp:Date.now(),dummy:Math.random(),btype:S.browser.name,bversion:S.browser.version,ostype:S.os.name,osversion:S.os.version,detail:u});y("report?".concat(p)).catch(w.a)}}var j=function(e){return y(e).then(function(e){return e.json()}).then(function(e){if(e.error){var t=new Error;throw t.payload=e.error,t}return e})},T=function(e){return e?function(e){return j("api/v4/videos/".concat(e))}(e).catch(function(t){throw P({msg:"playfailed",videoId:e,detail:"fetch-videoinfo-failure"}),t}):Promise.reject()},F=900;var R=n("/7Jz"),I=R.a.create({coverConverting:{position:"absolute",overflow:"hidden",top:"50%",transform:"translateY(-50%)",width:"100%",height:"100%"},coverBlurImage:{width:"100%",filter:"blur(8px)",transform:"scale(1.1)"},coverBlurTip:{position:"absolute","z-index":"1",top:"50%",left:"50%",color:"#fff",transform:"translate(-50%, -50%)"}}),L=function(e){var t=e.thumbnail,n=e.msg;return o.a.createElement("div",{className:Object(R.b)(I.coverConverting)},t&&o.a.createElement("img",{className:Object(R.b)(I.coverBlurImage),src:t}),o.a.createElement("div",{className:Object(R.b)(I.coverBlurTip)},n))},A=R.a.create({errorCover:{position:"absolute",overflow:"hidden",top:0,bottom:0,left:0,right:0,background:"#EBEBEB"},coverTip:{position:"absolute","z-index":"1",top:"50%",left:"50%",color:"#BFBFBF",transform:"translate(-50%, -50%)","white-space":"nowrap"}}),N=function(e){var t=e.msg;return o.a.createElement("div",{className:Object(R.b)(A.errorCover)},o.a.createElement("div",{className:Object(R.b)(A.coverTip)},t))},B=n("jcei"),_=function(){function e(t){var n=t.onStart,r=void 0===n?w.a:n,o=t.onStop,a=void 0===o?w.a:o;Object(c.a)(this,e),this._onStart=r,this._onStop=a,this._startTime=0}return Object(u.a)(e,[{key:"start",value:function(e){this.isRunning()||(this._startTime=Date.now(),this._onStart(this._startTime,e))}},{key:"reset",value:function(){this._startTime=0}},{key:"stop",value:function(e){if(this.isRunning()){var t=Date.now()-this._startTime;this._onStop(t,e),this.reset()}}},{key:"isRunning",value:function(){return this._startTime>0}}]),e}(),C=function(e){function t(){var e,n;Object(c.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(s.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).firstFrameStopwatch=new _({onStart:function(){return n.sendReport(O.PLAY_COUNT)},onStop:function(e){return n.sendReport(O.FIRST_FRAME_TIME,e)}}),n.bufferStopwatch=new _({onStop:function(e,t){e>100&&(n.sendReport(O.PLAY_BUFFERING,1e3*t),n.sendReport(O.BUFFERING_TIME,e))}}),n.eventSubscriptions=[],n.allowReportPlayfailed=!1,n.handleWaiting=function(){n.firstFrameStopwatch.isRunning()||n.bufferStopwatch.start()},n.handlePlaying=function(e){n.firstFrameStopwatch.stop(),n.bufferStopwatch.stop(e.currentTime)},n.sendReport=function(e,t){if(e===O.PLAY_FAILED){if(!n.allowReportPlayfailed)return;n.allowReportPlayfailed=!1}else e===O.PLAY_COUNT&&(n.allowReportPlayfailed=!0);n.props.sendReport(e,t)},n}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.subscribeEvent;this.eventSubscriptions=[t(B.b.PLAYER.PLAY_COUNT,function(){e.firstFrameStopwatch.start()}),t(B.b.PLAYER.PLAY_FAILED,function(t){var n=t.currentTime;e.sendReport(O.PLAY_FAILED,n)}),t(B.b.DOM.WAITING,this.handleWaiting),t(B.b.DOM.PLAYING,this.handlePlaying)]}},{key:"componentWillUnmount",value:function(){this.eventSubscriptions.forEach(function(e){return(0,e.unsubscribe)()})}},{key:"render",value:function(){return null}}]),t}(o.a.PureComponent),M=function(e){var t=e.id,n=e.useMSE;return o.a.createElement(h.b.Consumer,null,function(e){var r=e.subscribeEvent;return o.a.createElement(h.c.Consumer,null,function(e){var a=e.currentQuality,c=e.currentSrc;return o.a.createElement(C,{key:t,subscribeEvent:r,sendReport:function(e,t,n,r){if(!e||!t||!n)return w.a;var o=Object(i.parse)(n),a=o.v,c=o.bu,u=o.f,s=r?"webmse":"web";return function(n,r){return P({msg:n,id:e,time:r,quality:t,v:a,bu:c,f:u,platform:s})}}(t,a,c,n)})})})},D=n("ODXe"),Y=R.a.create({logo:{width:"40%",position:"absolute",top:"3%",right:"4%"}}),k="https://pic1.zhimg.com/80/v2-fa2fe8f24dcd80279239ede81144c23a_hd.png";function z(){return function(){var e=Object(r.useContext)(h.b).subscribeEvent,t=Object(r.useState)(!1),n=Object(D.a)(t,2),o=n[0],a=n[1];return Object(r.useEffect)(function(){if(Object(i.parse)(location.search).vzuu)return e(B.b.PLAYER.PLAY_COUNT,function(){a(!0)}).unsubscribe},[]),o}()&&o.a.createElement(h.a,null,o.a.createElement("img",{className:Object(R.b)(Y.logo),src:k}))}var U=["ld","sd","hd"];var x=n("UMpK"),K=n.n(x);var H=v()(navigator.userAgent),V=function(e){function t(){var e,n;Object(c.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(s.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).state={hasError:!1,error:null,data:null,id:null},n.load=function(){var e=n.props.id;return/^\d+$/.test(e)?T(e).then(function(e){return n.setState({data:e})}).catch(function(e){n.setState({hasError:!0,error:e.payload||null})}):(n.setState({hasError:!0,error:null}),Promise.reject())},n.onBeforePlay=function(e){return e?function(e){var t=Object(i.parse)(e).expiration,n=Date.now()/1e3;return t&&Number(t)<n+F}(e)?n.load():Promise.resolve():Promise.reject()},n}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.props.id&&this.load()}},{key:"componentDidUpdate",value:function(e){this.props.id!==e.id&&this.props.id&&this.load()}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.useMSE,r=e.playerProps,a=this.state,i=a.data,c=a.hasError,u=a.error;if(c&&u)return o.a.createElement(N,{msg:u.message||"\u89c6\u9891\u52a0\u8f7d\u5931\u8d25"});if(!i)return null;var s,l=i.title,d=i.cover_url,f=i.thumbnail,p=i.isConverting,m=(s=i.playlist,K()(s,function(e,t,n){e[n.toLowerCase()]=t})),v=H.browser,b=v.major,E=v.name,y=H.os.name,g=n&&"Chrome"===E&&b>=49&&"Android"!==y&&"iOS"!==y,w=function(e){var t=U.find(function(t){return Boolean(e[t])});return t?e[t]:null}(m)||{},O=w.duration,S=void 0===O?0:O,P=w.width,j=void 0===P?0:P,T=w.height,F=void 0===T?0:T;return p?o.a.createElement(L,{thumbnail:f,msg:"\u89c6\u9891\u6b63\u5728\u8f6c\u7801\u4e2d..."}):o.a.createElement(h.d,Object.assign({},r,{standalone:!0,id:t,title:l,error:c?u||{message:"\u89c6\u9891\u5df2\u88ab\u5220\u9664"}:null,cover:d,duration:S,sources:m,onBeforePlay:this.onBeforePlay,videoHeight:F,videoWidth:j,useMSE:g,locale:"zh-Hans",observeResize:!0,defaultQuality:"hd"}),o.a.createElement(M,{id:t,useMSE:n}),o.a.createElement(z,null))}}]),t}(r.Component);V.propTypes={id:p.a.string},V.defaultProps={id:null},V.getDerivedStateFromProps=function(e,t){return e.id!==t.id&&e.id?{hasError:!1,error:null,data:null,id:e.id}:null};var X=V;n("002B");function G(){return window.parent===window||/^https?:\/\/[^/]+\.(?:zhihu\.com|zhihu\.dev|vzuu\.com|candystars\.net|cntestdemo\.com)(?::\d+)?(?:\/|$)/.test(document.referrer)||/^https?:\/\/\d+\.\d+\.\d+\.\d+(?::\d+)?(?:\/|$)/.test(document.referrer)&&Object(i.parse)(location.search.replace("?","")).vzuu}var W=!0;function J(){if(G()){var e=(n=location.pathname.match(/^\/video\/(\d+)$/))&&n[1]?n[1]:null,t=function(){try{var e=Object(i.parse)(location.search);if(e.player)return JSON.parse(e.player)}catch(e){return}}();if(!W)return o.a.createElement(X,{id:e,useMSE:!1,playerProps:t});Object(a.render)(o.a.createElement(X,{id:e,useMSE:!1,playerProps:t}),document.getElementById("player"))}var n}J(),document.body.addEventListener("click",function(){}),document.body.addEventListener("touchstart",function(){}),document.body.addEventListener("touchend",function(){}),document.body.addEventListener("click",function(){},{capture:!0}),document.body.addEventListener("touchstart",function(){},{capture:!0}),document.body.addEventListener("touchend",function(){},{capture:!0})},kygt:function(e,t,n){"use strict";n.r(t);var r={host:"zhihu.".concat(location.host.includes("zhihu.dev")?"dev":"com")};t.default=r}},[[0,2,1]]]);
//# sourceMappingURL=client.2da224b8.chunk.js.map